library(NAIR)
library(dplyr)
library(igraph)
library(ggplot2)
setwd("D:/Mitch/Documents/Honours/Project/Network_analysis/Tp1-14_Tn1-8/IGRP_Tp1-14_Tn1-8_data/TETpos")
TETpos_files <- list.files(pattern = "\\.csv$")
for (file in TETpos_files) {
df_name <- gsub("\\.csv$", "", file)
assign(df_name, read.csv(file, stringsAsFactors = FALSE))
}
setwd("D:/Mitch/Documents/Honours/Project/Network_analysis/Tp1-14_Tn1-8/IGRP_Tp1-14_Tn1-8_data/CD8")
CD8_files <- list.files(pattern = "\\.csv$")
for (file in CD8_files) {
df_name <- gsub("\\.csv$", "", file)
assign(df_name, read.csv(file, stringsAsFactors = FALSE))
}
setwd("D:/Mitch/Documents/Honours/Project/Network_analysis/Tp1-14_Tn1-8")
CD8_1 <- `CD8-1`
CD8_2 <- `CD8-2`
CD8_3 <- `CD8-3`
CD8_4 <- `CD8-4`
CD8_5 <- `CD8-5`
CD8_6 <- `CD8-6`
CD8_7 <- `CD8-7`
CD8_8 <- `CD8-8`
TETpos_1 <- `TETpos-1`
TETpos_2 <- `TETpos-2`
TETpos_3 <- `TETpos-3`
TETpos_4 <- `TETpos-4`
TETpos_5 <- `TETpos-5`
TETpos_6 <- `TETpos-6`
TETpos_7 <- `TETpos-7`
TETpos_8 <- `TETpos-8`
TETpos_9 <- `TETpos-9`
TETpos_10 <- `TETpos-10`
TETpos_11 <- `TETpos-11`
TETpos_12 <- `TETpos-12`
TETpos_13 <- `TETpos-13`
TETpos_14 <- `TETpos-14`
rm(`CD8-1`, `CD8-2`, `CD8-3`, `CD8-4`, `CD8-5`, `CD8-6`, `CD8-7`, `CD8-8`)
rm(`TETpos-1`, `TETpos-2`, `TETpos-3`, `TETpos-4`, `TETpos-5`, `TETpos-6`, `TETpos-7`, `TETpos-8`, `TETpos-9`, `TETpos-10`, `TETpos-11`, `TETpos-12`, `TETpos-13`, `TETpos-14`)
exp <- rbind(CD8_1, CD8_2, CD8_3, CD8_4, CD8_5, CD8_6, CD8_7, CD8_8, TETpos_1, TETpos_2, TETpos_3, TETpos_4, TETpos_5, TETpos_6, TETpos_7, TETpos_8, TETpos_9, TETpos_10, TETpos_11, TETpos_12, TETpos_13, TETpos_14)
View(TETpos_9)
View(TETpos_8)
View(TETpos_9)
View(TETpos_8)
library(NAIR)
library(dplyr)
library(igraph)
library(ggplot2)
setwd("D:/Mitch/Documents/Honours/Project/Network_analysis/Tp1-14_Tn1-8/IGRP_Tp1-14_Tn1-8_data/TETpos")
TETpos_files <- list.files(pattern = "\\.csv$")
for (file in TETpos_files) {
df_name <- gsub("\\.csv$", "", file)
assign(df_name, read.csv(file, stringsAsFactors = FALSE))
}
setwd("D:/Mitch/Documents/Honours/Project/Network_analysis/Tp1-14_Tn1-8/IGRP_Tp1-14_Tn1-8_data/CD8")
CD8_files <- list.files(pattern = "\\.csv$")
for (file in CD8_files) {
df_name <- gsub("\\.csv$", "", file)
assign(df_name, read.csv(file, stringsAsFactors = FALSE))
}
setwd("D:/Mitch/Documents/Honours/Project/Network_analysis/Tp1-14_Tn1-8")
CD8_1 <- `CD8-1`
CD8_2 <- `CD8-2`
CD8_3 <- `CD8-3`
CD8_4 <- `CD8-4`
CD8_5 <- `CD8-5`
CD8_6 <- `CD8-6`
CD8_7 <- `CD8-7`
CD8_8 <- `CD8-8`
TETpos_1 <- `TETpos-1`
TETpos_2 <- `TETpos-2`
TETpos_3 <- `TETpos-3`
TETpos_4 <- `TETpos-4`
TETpos_5 <- `TETpos-5`
TETpos_6 <- `TETpos-6`
TETpos_7 <- `TETpos-7`
TETpos_8 <- `TETpos-8`
TETpos_9 <- `TETpos-9`
TETpos_10 <- `TETpos-10`
TETpos_11 <- `TETpos-11`
TETpos_12 <- `TETpos-12`
TETpos_13 <- `TETpos-13`
TETpos_14 <- `TETpos-14`
rm(`CD8-1`, `CD8-2`, `CD8-3`, `CD8-4`, `CD8-5`, `CD8-6`, `CD8-7`, `CD8-8`)
rm(`TETpos-1`, `TETpos-2`, `TETpos-3`, `TETpos-4`, `TETpos-5`, `TETpos-6`, `TETpos-7`, `TETpos-8`, `TETpos-9`, `TETpos-10`, `TETpos-11`, `TETpos-12`, `TETpos-13`, `TETpos-14`)
exp <- rbind(CD8_1, CD8_2, CD8_3, CD8_4, CD8_5, CD8_6, CD8_7, CD8_8, TETpos_1, TETpos_2, TETpos_3, TETpos_4, TETpos_5, TETpos_6, TETpos_7, TETpos_8, TETpos_9, TETpos_10, TETpos_11, TETpos_12, TETpos_13, TETpos_14)
setwd("D:/Mitch/Documents/Honours/Project/Network_analysis/Tp1-14_Tn1-8/IGRP_Tp1-14_Tn1-8_data/CD8")
CD8_files <- list.files(pattern = "\\.csv$")
for (file in CD8_files) {
df_name <- gsub("\\.csv$", "", file)
assign(df_name, read.csv(file, stringsAsFactors = FALSE))
}
setwd("D:/Mitch/Documents/Honours/Project/Network_analysis/Tp1-14_Tn1-8")
CD8_1 <- `CD8-1`
CD8_2 <- `CD8-2`
CD8_3 <- `CD8-3`
CD8_4 <- `CD8-4`
CD8_5 <- `CD8-5`
CD8_6 <- `CD8-6`
CD8_7 <- `CD8-7`
CD8_8 <- `CD8-8`
rm(`CD8-1`, `CD8-2`, `CD8-3`, `CD8-4`, `CD8-5`, `CD8-6`, `CD8-7`, `CD8-8`)
exp <- rbind(CD8_1, CD8_2, CD8_3, CD8_4, CD8_5, CD8_6, CD8_7, CD8_8, TETpos_1, TETpos_2, TETpos_3, TETpos_4, TETpos_5, TETpos_6, TETpos_7, TETpos_8, TETpos_9, TETpos_10, TETpos_11, TETpos_12, TETpos_13, TETpos_14)
metadata <- read.csv("IGRP_Tp1-14_Tn1-8_data/metadata.csv", header = TRUE)
net_merge <- exp %>%
left_join(metadata) %>%
group_by(exp, aaSeqCDR3, mouse, cells) %>% # add/change variables from your metadata
summarise(PID.count_sum = sum(PID.count),
PID.fraction_sum = sum(PID.fraction),
clone.fraction_sum = sum(cloneFraction),
clone.count_sum = sum(cloneCount))
net_merge <- net_merge %>%
mutate_if(is.factor, ~as.numeric(as.character(.)))
net_merge_TETpos <- net_merge %>%
filter(cells %in% c('TETpos'))
final_network_TETpos_75 <- net_merge_TETpos %>%
group_by(exp) %>%
arrange(desc(PID.count_sum))%>%
mutate(rank = 1:length(exp)) %>%
filter(rank <= 75) %>%
group_by(exp, aaSeqCDR3, mouse) %>%
group_by(aaSeqCDR3)
View(final_network_TETpos_75)
View(metadata)
View(final_network_TETpos_75)
final_network_TETpos_60 <- net_merge_TETpos %>%
group_by(exp) %>%
arrange(desc(PID.count_sum))%>%
mutate(rank = 1:length(exp)) %>%
filter(rank <= 60) %>%
group_by(exp, aaSeqCDR3, mouse) %>%
group_by(aaSeqCDR3)
View(TETpos_11)
View(TETpos_10)
View(TETpos_11)
View(TETpos_10)
View(TETpos_1)
library(NAIR)
library(dplyr)
library(igraph)
library(ggplot2)
setwd("D:/Mitch/Documents/Honours/Project/Network_analysis/Tp1-14_Tn1-8/IGRP_Tp1-14_Tn1-8_data/TETpos")
TETpos_files <- list.files(pattern = "\\.csv$")
for (file in TETpos_files) {
df_name <- gsub("\\.csv$", "", file)
assign(df_name, read.csv(file, stringsAsFactors = FALSE))
}
setwd("D:/Mitch/Documents/Honours/Project/Network_analysis/Tp1-14_Tn1-8/IGRP_Tp1-14_Tn1-8_data/CD8")
CD8_files <- list.files(pattern = "\\.csv$")
for (file in CD8_files) {
df_name <- gsub("\\.csv$", "", file)
assign(df_name, read.csv(file, stringsAsFactors = FALSE))
}
setwd("D:/Mitch/Documents/Honours/Project/Network_analysis/Tp1-14_Tn1-8")
CD8_1 <- `CD8-1`
CD8_2 <- `CD8-2`
CD8_3 <- `CD8-3`
CD8_4 <- `CD8-4`
CD8_5 <- `CD8-5`
CD8_6 <- `CD8-6`
CD8_7 <- `CD8-7`
CD8_8 <- `CD8-8`
TETpos_1 <- `TETpos-1`
TETpos_2 <- `TETpos-2`
TETpos_3 <- `TETpos-3`
TETpos_4 <- `TETpos-4`
TETpos_5 <- `TETpos-5`
TETpos_6 <- `TETpos-6`
TETpos_7 <- `TETpos-7`
TETpos_8 <- `TETpos-8`
TETpos_9 <- `TETpos-9`
TETpos_10 <- `TETpos-10`
TETpos_11 <- `TETpos-11`
TETpos_12 <- `TETpos-12`
TETpos_13 <- `TETpos-13`
TETpos_14 <- `TETpos-14`
rm(`CD8-1`, `CD8-2`, `CD8-3`, `CD8-4`, `CD8-5`, `CD8-6`, `CD8-7`, `CD8-8`)
rm(`TETpos-1`, `TETpos-2`, `TETpos-3`, `TETpos-4`, `TETpos-5`, `TETpos-6`, `TETpos-7`, `TETpos-8`, `TETpos-9`, `TETpos-10`, `TETpos-11`, `TETpos-12`, `TETpos-13`, `TETpos-14`)
exp <- rbind(CD8_1, CD8_2, CD8_3, CD8_4, CD8_5, CD8_6, CD8_7, CD8_8, TETpos_1, TETpos_2, TETpos_3, TETpos_4, TETpos_5, TETpos_6, TETpos_7, TETpos_8, TETpos_9, TETpos_10, TETpos_11, TETpos_12, TETpos_13, TETpos_14)
metadata <- read.csv("IGRP_Tp1-14_Tn1-8_data/metadata.csv", header = TRUE)
net_merge <- exp %>%
left_join(metadata) %>%
group_by(exp, aaSeqCDR3, mouse, cells) %>% # add/change variables from your metadata
summarise(PID.count_sum = sum(PID.count),
PID.fraction_sum = sum(PID.fraction),
clone.fraction_sum = sum(cloneFraction),
clone.count_sum = sum(cloneCount))
net_merge <- net_merge %>%
mutate_if(is.factor, ~as.numeric(as.character(.)))
View(TETpos_10)
View(net_merge)
net_merge_TETpos <- net_merge %>%
filter(cells %in% c('TETpos'))
final_network_TETpos_75 <- net_merge_TETpos %>%
group_by(exp) %>%
arrange(desc(PID.count_sum))%>%
mutate(rank = 1:length(exp)) %>%
filter(rank <= 75) %>%
group_by(exp, aaSeqCDR3, mouse) %>%
group_by(aaSeqCDR3)
View(final_network_TETpos_75)
final_network_TETpos_75_counts <- final_network_TETpos_75 %>%
group_by(aaSeqCDR3) %>%
mutate(unique_mouse_count = n_distinct(mouse)) %>%
ungroup()
keep_column <- c("aaSeqCDR3", "unique_mouse_count")
final_network_TETpos_75_counts <- final_network_TETpos_75_counts %>%
select(all_of(keep_column))
final_network_TETpos_75_counts <- final_network_TETpos_75_counts %>%
distinct(aaSeqCDR3, .keep_all = TRUE)
write.csv(final_network_TETpos_75_counts, "TETpos_75_counts.csv", row.names = FALSE, quote = FALSE)
final_network_TETpos_75_seq <- final_network_TETpos_75 %>%
select(aaSeqCDR3)
final_network_TETpos_75_seq <- final_network_TETpos_75_seq %>%
distinct(aaSeqCDR3)
net <- buildNet(final_network_TETpos_75_seq,
seq_col = "aaSeqCDR3",
dist_type = "lev",
node_stats = TRUE,
stats_to_include = "all",
cluster_stats = TRUE,
color_scheme = c("default"),
node_size_limits = c(2.0, 2.5),
plot_title = c("TETpos Top 75"),
plot_subtitle = NULL,
print_plots = TRUE,
output_dir = ("TETpos_75_outputs"),
output_type = "individual"
)
net <- labelNodes(net, "aaSeqCDR3", size = 0.5)
net$plots[[1]]
node_seq <- read.csv("TETpos_75_outputs/MyRepSeqNetwork_NodeMetadata.csv", header = TRUE, stringsAsFactors = FALSE)
edge_list <- read.table("TETpos_75_outputs/MyRepSeqNetwork_EdgeList.txt", sep = "", header = FALSE)
new_column <- 0:(nrow(node_seq) - 1)
node_seq <- cbind(new_column, node_seq)
node_seq <- node_seq %>%
select(new_column, aaSeqCDR3)
network_table <- edge_list %>%
left_join(node_seq, by = c("V1" = "new_column")) %>%
rename(AA_Seq1 = aaSeqCDR3) %>%
select(-V1) %>%
left_join(node_seq, by = c("V2" = "new_column")) %>%
rename(AA_Seq2 = aaSeqCDR3) %>%
select(AA_Seq1, AA_Seq2)
write.csv(network_table, "Cytoscape_inputs/Cytoscape__TETpos_1-14_75.csv", row.names = FALSE, quote = FALSE)
write.csv(network_table, "Cytoscape_inputs/Cytoscape_TETpos_1-14_75.csv", row.names = FALSE, quote = FALSE)
View(final_network_TETpos_75)
View(net_merge)
View(exp)
View(final_network_TETpos_75)
